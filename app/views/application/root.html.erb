<div id="info">
  <p id="info-title">A B O U T</p>
  <p>
    BRDR (as in 'Birder') is a tool for discovering and identifying birds in your neighborhood.
    It was built by Reuben Son as a student at The Flatiron School using Ruby/Rails, Javscript, jQuery, and AJAX.
  </p>
  <p>
    Bird observation data is obtained through API calls to the eBird database, which was created
    in 2002 by the National Audubon Society and the Cornell Lab of Ornithology to log birding submitted
    provided by birders across the globe.
    Additionally, information and images specific to each bird species is supplied by
    querying the Wikipedia API.
  </p>
  <p>
    Email Reuben at
    reuben.son@flatironschool.com
    with feature suggestions, bug reports, and more.
    If you'd like to contribute to, or check out the codebase, visit:
  </p>
  <p>
    <a href="https://github.com/reubenson/BRDR">https://github.com/reubenson/BRDR</a>
  </p>
</div>

<div class="container">
  <div class="row">
    <div class="col-xs-4">
      <div id="notice">
        <%= @collection_view_object.notice %>
        <% if @collection_view_object.show_popular_searches %>
          <br><br>
          <% @collection_view_object.popular_searches.each do |term| %>
            <%= render partial: "report_collection/popular_search", locals:{term: term}, layout: false %>
          <% end %>
        <% end %>
      </div>

      <%= form_tag('', remote: true, class: 'filter-species' ) do %>
        <%= text_field_tag 'search', '', placeholder: 'Filter Results (e.g. "Owl")', class: 'form-control' %>
      <% end %>

      <%= select_tag "bird-select", options_from_collection_for_select(@collection.reports_sorted_alphabetically, "sci_name", "com_name"), prompt: "List of Birds" %>

      <ul class="list-group" id="species-list" data-lat="<%= @collection.latitude %>" data-lng="<%= @collection.longitude %>">
      <% @collection.reports.sort{|x,y| x.com_name <=> y.com_name}.each do |report| %>
        <a href="#">
          <li class="select_species list-group-item" data-species="<%= report.sci_name %>">
            <a class="species-name"><%= report.com_name %></a>
          </li>
        </a>
      <% end %>
      </ul>
    </div>

    <div class="col-xs-8">
      <div id="mobile-buttons">
          <button id="bird-bio-btn" class="mobile-button">B I O</button>
          <button id="bird-map-btn" class="mobile-button active">M A P</button>
      </div>
      <div id="view-title">
        <h3>
          Bird Name
        </h3>
        <a href="#" id="view-button">(Hide Bio)</a>
        <!-- <button id="view-button">-</button> -->
        <!-- <a href="#" id="view-button">Hide Bio</a> -->
      </div>
      <div id="wikipedia-info-background" class="make-background"></div>
      <div id="wikipedia-info">
        <figure>
          <a>
            <img></img>
          </a>
          <figcaption></figcaption>
        </figure>
      </div>
      <div id="map-container">
        <div id="map"></div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
function initMap() {
  var user_loc = new google.maps.LatLng(<%= @collection.latitude %> , <%= @collection.longitude %>);

  var mapOptions = {
    zoom: 9,
    center: user_loc,
    scrollwheel: false,
    streetViewControl: false,
    mapTypeControl: false
  };

  map = new google.maps.Map(document.getElementById("map"), mapOptions);

  var user_marker = new google.maps.Marker({
    icon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png',
    position: user_loc,
    map: map,
    title: "Your Location"
  });
  // markers.push(user_marker);

  <% @collection.reports.each do |report| %>
    var myLatlng = new google.maps.LatLng(<%= report.lat %>,<%= report.lng %>);
    var marker = new google.maps.Marker({
        position: myLatlng,
        map: map,
        title: "<%= report.com_name %> (Observed on <%= report.obs_dt %>)"
    });
    markers.push(marker);
  <% end %>



  map.setOptions({styles: styles});

  setMapSize();
}
</script>
