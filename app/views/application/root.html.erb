<div class="container">
  <div class="row">
    <div class="col-xs-4">
      <div id="notice"><%= notice %></div>

      <%= form_tag('', remote: true, class: 'filter-species' ) do %>
        <%= text_field_tag 'search', '', placeholder: 'filter results (e.g. "owl")', class: 'form-control' %>
      <% end %>

      <%= select_tag "bird-select", options_from_collection_for_select(@collection.reports.sort{|x,y| x.com_name <=> y.com_name}, "sci_name", "com_name"), prompt: "List of Birds" %>

      <ul class="list-group" id="species-list" data-lat="<%= @collection.latitude %>" data-lng="<%= @collection.longitude %>">
      <% @collection.reports.sort{|x,y| x.com_name <=> y.com_name}.each do |report| %>
      <a href="#">
        <li class="select_species list-group-item" data-species="<%= report.sci_name %>">
          <a class="species-name"><%= report.com_name %></a>
          <div class="wikipedia-info">
            <div class="wikipedia-img"></div>
            <div class="wikipedia-text"></div>
          </div>
        </li>
      </a>
      <% end %>
      </ul>
    </div>

    <div class="col-xs-8">
      <div id="map"></div>
    </div>
  </div>
</div>

<script type="text/javascript">
function initMap() {
  var myLatlng = new google.maps.LatLng(<%= @collection.latitude %> , <%= @collection.longitude %>);

  var mapOptions = {
    zoom: 10,
    center: myLatlng,
    scrollwheel: false
  };

  map = new google.maps.Map(document.getElementById("map"), mapOptions);
  <% @collection.search_species.each do |report| %>
    var myLatlng = new google.maps.LatLng(<%= report.lat %>,<%= report.lng %>);

    var marker = new google.maps.Marker({
        position: myLatlng,
        map: map,
        title: "<%= report.com_name %> (Observed on <%= report.obs_dt %>)"
    });
    markers.push(marker);
  <% end %>
}
</script>
